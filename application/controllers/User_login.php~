<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');

class User_login extends CI_Controller
{   
    public function __construct()
    {
        parent::__construct();
        $this->load->model('User_login_model');
        $this->load->helper(array('form', 'url'));
    }
	//$this->load->view('frontend/home');
	//$this->load->view('frontend/blog'); 
	//$this->load->view('frontend/blog-single'); 
	//$this->load->view('frontend/checkout'); 
	//$this->load->view('frontend/contact-us'); 
	//$this->load->view('frontend/cart');
	public function index()
	{

		 echo "stringvvvvvvvvvvvvvv";
 die();

	    $data = array(
			'firstname' => $this->input->post('first_name'),
			'lastname' => $this->input->post('last_name'),
			'email' => $this->input->post('email_add'),
			'password' => $this->input->post('password'),
			'role_type' => '5'
			);
		
		if(!empty($data)){
		    $this->form_validation->set_rules('first_name', 'Firstname', 'trim|required');
		    $this->form_validation->set_rules('last_name', 'Lastname', 'trim|required');
		    $this->form_validation->set_rules('email_add', 'Email', 'trim|required|is_unique[users.email]');
		    $this->form_validation->set_rules('password', 'Password', 'trim|required');
		    $this->form_validation->set_rules('conf_pwd', 'Password', 'trim|required|matches[password]');

			if ($this->form_validation->run() == TRUE) 
			{
				$this->User_login_model->registration($data);
				$this->session->set_flashdata('success','User registaration successfull !');
		        redirect('index.php/user_login');	
			}
			$this->load->view('frontend/header');
			$this->load->view('frontend/user_login'); 
			$this->load->view('frontend/footer');
		}
	}

	public function login()
	{
			$data = array(
			'email' => $this->input->post('login_email'),
			'password' => $this->input->post('login_password'),
			);

			if(!empty($data))
			{
		    $this->form_validation->set_rules('login_email', 'Email', 'required');
		    $this->form_validation->set_rules('login_password', 'Password', 'required');

		    	if($this->form_validation->run() == TRUE )
		    	{
		    		$email = $this->input->post('login_email');
					$password = $this->input->post('login_password');
					$result = $this->User_login_model->login($email,$password);

						if(!empty($result))
						{
							$role = $result[0]['role_type'];
							if ($role == 5) 
							{
					        $this->session->set_userdata('user_login',$result);
                            redirect('index.php/Home');
							}    							  
						}
						else
						{
							$this->session->set_flashdata('fail','Please provide correct email and password.');
							redirect('index.php/user_login');
						}
				}
				$this->session->set_flashdata('fail','Please provide correct email and password.');
				redirect('index.php/user_login');
			}	
	}

	public function facebook_login()
	{
 echo "string";
 die();

	}

}

